{"version":3,"sources":["render.js"],"names":["TipsType","tipsNormal","tipsPrimary","tipsSuccess","tipsInfo","tipsWarning","tipsDanger","TitleType","admin","owner","beforeRenderingHTML","data","chatboxClass","htmlStr","chatBox","document","querySelector","i","length","isRender","messageType","indexOf","renderTipHtml","html","renderMessageHtml","insertAdjacentHTML","setTimeout","scrollHeight","clientHeight","scrollTop","position","diamond","headIcon","renderTitleHtml","htitle","htitleType","escapeHtml","name","content","css","unsafe","replace","c","charCodeAt","slice"],"mappings":";;;;;;AAAA,IAAMA,QAAQ,GAAG;EACfC,UAAU,EAAE,MAAM;EAClBC,WAAW,EAAE,cAAc;EAC3BC,WAAW,EAAE,cAAc;EAC3BC,QAAQ,EAAE,WAAW;EACrBC,WAAW,EAAE,cAAc;EAC3BC,UAAU,EAAE;AACd,CAAC;AACD,IAAMC,SAAS,GAAG;EAChBC,KAAK,EAAE,OAAO;EACdC,KAAK,EAAE;AACT,CAAC;AAED,SAASC,mBAAmB,CAACC,IAAI,EAAEC,YAAY,EAAE;EAC/C,IAAIC,OAAO,GAAG,EAAE;EAChB,IAAIC,OAAO,GAAGC,QAAQ,CAACC,aAAa,CAACJ,YAAY,CAAC;EAClD,KAAK,IAAIK,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGN,IAAI,CAACO,MAAM,EAAED,CAAC,EAAE,EAAE;IACpC,IAAIN,IAAI,CAACM,CAAC,CAAC,CAACE,QAAQ,EAAE;MACpB;IACF;IACA,IAAIR,IAAI,CAACM,CAAC,CAAC,CAACG,WAAW,CAACC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE;MAC9CR,OAAO,IAAIS,aAAa,CAACX,IAAI,CAACM,CAAC,CAAC,CAACM,IAAI,EAAEvB,QAAQ,CAACW,IAAI,CAACM,CAAC,CAAC,CAACG,WAAW,CAAC,IAAI,MAAM,CAAC;IACjF,CAAC,MAAM;MACLP,OAAO,IAAIW,iBAAiB,CAACb,IAAI,CAACM,CAAC,CAAC,CAAC;IACvC;IACAN,IAAI,CAACM,CAAC,CAAC,CAACE,QAAQ,GAAG,IAAI;EACzB;EAEAL,OAAO,CAACW,kBAAkB,CAAC,WAAW,EAACZ,OAAO,CAAC;EAC/Ca,UAAU,CAAC,YAAM;IACf,IAAIZ,OAAO,CAACa,YAAY,GAAGb,OAAO,CAACc,YAAY,EAAE;MAC/Cd,OAAO,CAACe,SAAS,GAAGf,OAAO,CAACa,YAAY;MACxCb,OAAO,GAAG,EAAE;MACZD,OAAO,GAAG,EAAE;IACd;EACF,CAAC,EAAE,GAAG,CAAC;AACT;AAEA,SAASW,iBAAiB,CAACb,IAAI,EAAE;EAC/B,+BAAuBA,IAAI,CAACmB,QAAQ,qDACPnB,IAAI,CAACoB,OAAO,GAAG,EAAE,GAAG,QAAQ,sBAAUpB,IAAI,CAACqB,QAAQ,4HAEpEC,eAAe,CAACtB,IAAI,CAACuB,MAAM,EAAE3B,SAAS,CAACI,IAAI,CAACwB,UAAU,CAAC,IAAI,EAAE,CAAC,iCACxDC,UAAU,CAACzB,IAAI,CAAC0B,IAAI,CAAC,IAAI,QAAQ,uEAErB1B,IAAI,CAACS,WAAW,KAAK,KAAK,GAAGT,IAAI,CAACY,IAAI,GAAGa,UAAU,CAACzB,IAAI,CAACY,IAAI,CAAC;AAE9F;AAEA,SAASU,eAAe,CAACK,OAAO,EAAEC,GAAG,EAAE;EACrC,IAAI,CAACD,OAAO,EAAE,OAAO,EAAE;EACvB,sCAA8BC,GAAG,6CAAgCD,OAAO;AAC1E;AAEA,SAAShB,aAAa,CAACgB,OAAO,EAAEC,GAAG,EAAE;EACnC,IAAI,CAACD,OAAO,EAAE,OAAO,EAAE;EACvB,mDAAyCC,GAAG,+CAAkCH,UAAU,CAACE,OAAO,CAAC;AACnG;;AAEA;AACA;AACA,SAASF,UAAU,CAACI,MAAM,EAAE;EAC1B,OAAOA,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEC,OAAO,CACpB,yDAAyD,EACzD,UAAAC,CAAC;IAAA,OAAI,IAAI,GAAG,CAAC,KAAK,GAAGA,CAAC,CAACC,UAAU,CAAC,CAAC,CAAC,EAAEC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG;EAAA,EACtD;AACH","file":"../litewebchat_render.js","sourcesContent":["const TipsType = {\n  tipsNormal: 'tips',\n  tipsPrimary: 'tips-primary',\n  tipsSuccess: 'tips-success',\n  tipsInfo: 'tips-info',\n  tipsWarning: 'tips-warning',\n  tipsDanger: 'tips-danger',\n};\nconst TitleType = {\n  admin: 'admin',\n  owner: 'owner',\n};\n\nfunction beforeRenderingHTML(data, chatboxClass) {\n  let htmlStr = '';\n  let chatBox = document.querySelector(chatboxClass);\n  for (let i = 0; i < data.length; i++) {\n    if (data[i].isRender) {\n      continue;\n    }\n    if (data[i].messageType.indexOf('tips') !== -1) {\n      htmlStr += renderTipHtml(data[i].html, TipsType[data[i].messageType] || 'tips');\n    } else {\n      htmlStr += renderMessageHtml(data[i]);\n    }\n    data[i].isRender = true;\n  }\n\n  chatBox.insertAdjacentHTML('beforeend',htmlStr);\n  setTimeout(() => {\n    if (chatBox.scrollHeight > chatBox.clientHeight) {\n      chatBox.scrollTop = chatBox.scrollHeight;\n      chatBox = '';\n      htmlStr = '';\n    }\n  }, 300);\n}\n\nfunction renderMessageHtml(data) {\n  return `<div class=\"c${data.position} cmsg\">\n        <img class=\"headIcon ${data.diamond ? '' : 'radius'}\" src=\"${data.headIcon}\" ondragstart=\"return false;\" oncontextmenu=\"return false;\"/>\n        <span class=\"name\">\n            ${renderTitleHtml(data.htitle, TitleType[data.htitleType] || '')}\n            <span>${escapeHtml(data.name) || '&nbsp;'}</span>\n        </span>\n        <span class=\"content\">${data.messageType === 'raw' ? data.html : escapeHtml(data.html)}</span>\n    </div>`;\n}\n\nfunction renderTitleHtml(content, css) {\n  if (!content) return '';\n  return `<span class=\"htitle ${css}\" style=\"margin: 0 4px 0 0;\">${content}</span>`;\n}\n\nfunction renderTipHtml(content, css) {\n  if (!content) return '';\n  return `<div class=\"tips\"><span class=\"${css}\" style=\"margin-bottom: 20px;\">${escapeHtml(content)}</span></div>`;\n}\n\n// 转义 C0 Controls and Basic Latin 中非数字和字母，C1 Controls and Latin-1 Supplement 全部\n// https://www.w3schools.com/charsets/ref_html_utf8.asp\nfunction escapeHtml(unsafe) {\n  return unsafe?.replace(\n    /[\\u0000-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u00FF]/g,\n    c => '&#' + ('000' + c.charCodeAt(0)).slice(-4) + ';'\n  )\n}\n"]}